<div *ngIf="AttendanceApiData">
  <div *ngIf="AttendanceApiData.length>0">
    <div class="row" *ngFor="let OneAttendance of AttendanceApiData"
      style="border:1px solid #028fcf;margin: 0px;margin-bottom:10px;padding: 20px 10px;">
      <div class="col-md-2 P_base">
        <p>{{OneAttendance.EmpCode}} {{OneAttendance.EmpName}}</p>
        <p>{{OneAttendance.DeptName}}</p>
      </div>
      <div class="col-md-10 row" style="margin: 0px">
        <div class="col-md-3 P_date">
          <p style="color: #028fcf;font-weight: bold">{{OneAttendance.AttendDate}} ({{OneAttendance.DayOfweek}})</p>
          <div class="Rote">
            <span class="RoteLink" (click)="bt_Show_RoteInfo(OneAttendance.ActualRote.RoteID)">{{OneAttendance.RoteNameC}}</span>
            <span style="color: #b1b1b1"
              *ngIf="OneAttendance.ActualRote.FlexibleMinuteForward > 0 || OneAttendance.ActualRote.FlexibleMinuteBehind > 0">(彈性)
            </span>
            <ng-container *ngIf="OneAttendance.RoteNameC!='休息日' && OneAttendance.RoteNameC!='例假日'">
              / {{OneAttendance.OnTime}}-{{OneAttendance.OffTime}}
              <!-- <div *ngIf="OneAttendance.OffTime_calCrossDay" style="display: inline-block;
                    height: 20px;
                    font-size: 13px;
                    width: 40px;
                    text-align: center;
                    color: #fff;
                    background-color: #408cb6;
                    border: 1px solid;
                    border-radius: 15px;">+1日</div> -->
            </ng-container>
          </div>
        </div>
        <div class="col-md-4 row" style="margin: 0px;padding:0px">
          <div class="col-md-4 col-xs-4" style="padding: 0px;">
            <p style="color: #969696">刷到</p>
            <p *ngIf="OneAttendance.OnCardTime" style="display: inline-block">{{OneAttendance.OnCardTime}}</p>
            <p *ngIf="!OneAttendance.OnCardTime">無</p>
            <div *ngIf="OneAttendance.OnCardTime_calCrossDay" style="display: inline-block;
                  height: 20px;
                  font-size: 13px;
                  width: 40px;
                  text-align: center;
                  color: #fff;
                  background-color: #408cb6;
                  border: 1px solid;
                  border-radius: 15px;">+1日</div>
          </div>
          <div class="col-md-4 col-xs-4" style="padding: 0px;">
            <p style="color: #969696">刷離</p>
            <p *ngIf="OneAttendance.OffCardTime" style="display: inline-block">{{OneAttendance.OffCardTime}}</p>
            <p *ngIf="!OneAttendance.OffCardTime">無</p>
            <div *ngIf="OneAttendance.OffCardTime_calCrossDay" style="display: inline-block;
                  height: 20px;
                  font-size: 13px;
                  width: 40px;
                  text-align: center;
                  color: #fff;
                  background-color: #408cb6;
                  border: 1px solid;
                  border-radius: 15px;">+1日</div>
          </div>
          <div class="col-md-4 col-xs-4" style="padding: 0px;">
            <p style="color: #969696">假單</p>
            <a *ngIf="OneAttendance.AttendAbsInfo" style="cursor: pointer;"
              (click)="vaClick(OneAttendance.AttendDate,OneAttendance.EmpCode)">請假單</a>
            <p *ngIf="!OneAttendance.AttendAbsInfo">無</p>
          </div>
        </div>
        <div class="col-md-3" style="padding: 0px;">
          <p style="color: #969696">通勤狀態</p>
          <div class="tag_blue " *ngIf="OneAttendance.Ride">搭車</div>
          <div class="tag_yellow" *ngIf="OneAttendance.Behind">車誤</div>
          <div class="tag_blue" *ngIf="OneAttendance.FlexibleMinute">彈性</div>
          <p *ngIf="!OneAttendance.Ride && !OneAttendance.Behind && !OneAttendance.FlexibleMinute">無</p>
        </div>
        <div class="col-md-2" style="padding: 0px;">
          <p style="color: #969696">考勤狀態</p>
          <div class="tag_red" *ngIf="OneAttendance.LateMins">遲到</div>
          <div class="tag_blue" *ngIf="!OneAttendance.LateMins && !OneAttendance.IsAbsent && !OneAttendance.EarlyMins">
            正常
          </div>
          <div class="tag_red" style="width: 65px;" *ngIf="OneAttendance.IsAbsent">未刷卡</div>
          <div class="tag_red" *ngIf="OneAttendance.EarlyMins">早退</div>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="AttendanceApiData && AttendanceApiData.length==0">
  此查詢區間無資料
</div>



<div class="modal" id="RecentHoliday" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="vertical-alignment-helper">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
          <div style="text-align: center">
            <h3 style="margin: 0px">{{SearchAttendDate}} 請假資訊</h3>
          </div>
        </div>
        <div class="modal-body" style="padding: 25px;padding-top: 15px;">
          <div class="row P_div" *ngFor="let oneVaData of ShowVa ; let i = index">
            <div class="row col-md-2 col-xs-12 P_padding" style="margin: 0px">
              <div class="col-md-12   col-xs-6 P_left" style="color: #028fcf;padding:0px;
                  margin-bottom: 10px;">
                請假明細<span>{{showDay(i)}}</span>
              </div>
              <div class="col-md-12   col-xs-6" style="padding: 0;text-align: right;">
                <div class="tag_blue" *ngIf="oneVaData.State=='1'">呈核中</div>
                <div class="tag_skyblue" *ngIf="oneVaData.State=='3'">已核准</div>
                <div class="tag_red" *ngIf="oneVaData.State=='2'">重擬</div>
                <div class="tag_gray" *ngIf="oneVaData.State=='7'">已抽單</div>
              </div>
            </div>
            <div class="row col-md-7 col-xs-10" style="margin: 0px;padding: 0">
              <div class="col-md-12 col-xs-12" style="margin: 0px;color:#6f6f6f;padding: 0;
                  margin-bottom: 10px;">
                <div class="row" style="margin: 0;padding-bottom: 5px;">
                  <div class="col-md-6 col-xs-12" style="padding: 0">
                    <span style="color: #969696">起始：</span>
                    <!--2019/01/18 08:00-->{{oneVaData.showDateB}} {{oneVaData.showTimeB}}
                  </div>
                  <div class="col-md-6 col-xs-12" style="padding: 0">
                    <span style="color: #969696">結束：</span>
                    <!--2019/01/18 12:00-->{{oneVaData.showDateE}} {{oneVaData.showTimeE}}
                  </div>
                </div>
              </div>
              <div class="col-md-12 col-xs-12" style="margin: 0px;color:#6f6f6f;padding: 0">
                <div class="row" style="margin: 0;padding-bottom: 5px;">
                  <div *ngIf="!oneVaData.showSignDate" class="col-md-6 col-xs-12" style="padding: 0">
                    <span style="color: #969696">批核：</span>
                    <!--2019/01/18 08:00-->尚未批核
                  </div>
                  <div *ngIf="oneVaData.showSignDate" class="col-md-6 col-xs-12" style="padding: 0">
                    <span style="color: #969696">批核：</span>
                    <!--2019/01/18 08:00-->{{oneVaData.showSignDate}} {{oneVaData.showSignTime}}
                  </div>
                  <div class="col-md-6 col-xs-12" style="padding: 0">
                    <span style="color: #969696">假別：</span>
                    <!-- 特別休假 -->{{oneVaData.HoliDayNameC}}
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-3 col-xs-12" style="padding: 0">
              <div class="P_All">共計 {{oneVaData.day}} 日 {{oneVaData.hour}} 時 {{oneVaData.minute}} 分</div>
            </div>
          </div>

        </div>
        <div class="modal-footer">
          <div style="text-align: center">
            <button type="button" class="btn btn-default" data-dismiss="modal">關閉</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--dialog查閱請假單-->

<div class="modal" id="RoteInf" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="vertical-alignment-helper">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">×</span>
          </button>
          <!-- <h4 class="modal-title" id="mySmallModalLabel">{{showSearchEmp.EmpCode}} 出勤班表</h4> -->
          <h4 class="modal-title" id="mySmallModalLabel">班型資訊</h4>
        </div>
        <div class="modal-body">
          <app-rote-inf [GetRoteInfo$]="Ob_setGetRoteInfo$"></app-rote-inf>
          <div style="text-align: center">
            <button type="button" class="btn btn-primary" data-dismiss="modal">確定</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!--dialog班表期間-->